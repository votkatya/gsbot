# üèóÔ∏è –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ "–ì–æ—Ä–æ–¥ –°–ø–æ—Ä—Ç–∞" –Ω–∞ Timeweb

> –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é –∏ —Ä–∞–±–æ—Ç–µ Telegram Mini App –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ Timeweb

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 12 —Ñ–µ–≤—Ä–∞–ª—è 2026
**–í–µ—Ä—Å–∏—è:** 1.0
**–ê–≤—Ç–æ—Ä:** –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –¥–ª—è –∫–æ–º–∞–Ω–¥—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

---

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–û–±—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞](#–æ–±—â–∞—è-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)
2. [–°–µ—Ä–≤–µ—Ä–Ω–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞](#—Å–µ—Ä–≤–µ—Ä–Ω–∞—è-–∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞)
3. [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-—Ñ–∞–π–ª–æ–≤-–Ω–∞-—Å–µ—Ä–≤–µ—Ä–µ)
4. [–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Nginx](#–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è-nginx)
5. [Backend (Node.js API)](#backend-nodejs-api)
6. [Frontend (React Mini App)](#frontend-react-mini-app)
7. [–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö PostgreSQL](#–±–∞–∑–∞-–¥–∞–Ω–Ω—ã—Ö-postgresql)
8. [–ü—Ä–æ—Ü–µ—Å—Å –¥–µ–ø–ª–æ—è](#–ø—Ä–æ—Ü–µ—Å—Å-–¥–µ–ø–ª–æ—è)
9. [–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏](#–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥-–∏-–ª–æ–≥–∏)
10. [Troubleshooting](#troubleshooting)

---

## üèõÔ∏è –û–±—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–ü—Ä–æ–µ–∫—Ç —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ —Ç—Ä–µ—Ö –æ—Å–Ω–æ–≤–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                        –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–¨                          ‚îÇ
‚îÇ                     (Telegram Mini App)                      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                         ‚îÇ
                         ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                   TIMEWEB SERVER (Ubuntu 22.04)              ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ  Nginx (Port 80/443) - Reverse Proxy + Static Files  ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îÇ          ‚îÇ                                  ‚îÇ                ‚îÇ
‚îÇ          ‚ñº                                  ‚ñº                ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê         ‚îÇ
‚îÇ  ‚îÇ  Static      ‚îÇ                  ‚îÇ  Node.js     ‚îÇ         ‚îÇ
‚îÇ  ‚îÇ  Files       ‚îÇ                  ‚îÇ  Backend     ‚îÇ         ‚îÇ
‚îÇ  ‚îÇ  (React App) ‚îÇ                  ‚îÇ  (Port 3000) ‚îÇ         ‚îÇ
‚îÇ  ‚îÇ  /deploy/    ‚îÇ                  ‚îÇ  /bot/       ‚îÇ         ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò         ‚îÇ
‚îÇ                                            ‚îÇ                 ‚îÇ
‚îÇ                                            ‚ñº                 ‚îÇ
‚îÇ                                   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê          ‚îÇ
‚îÇ                                   ‚îÇ  PostgreSQL  ‚îÇ          ‚îÇ
‚îÇ                                   ‚îÇ  (Port 5432) ‚îÇ          ‚îÇ
‚îÇ                                   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                         ‚îÇ
                         ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ              Cloudflare Workers (Telegram Bot)               ‚îÇ
‚îÇ                  https://bot.workers.dev                     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üñ•Ô∏è –°–µ—Ä–≤–µ—Ä–Ω–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–µ—Ä–≤–µ—Ä–∞

- **–•–æ—Å—Ç–∏–Ω–≥:** Timeweb
- **–û–°:** Ubuntu 22.04.5 LTS (GNU/Linux 5.15.0-168-generic x86_64)
- **IP:** 91.198.220.52
- **–î–æ–º–µ–Ω:** gsbot18.ru
- **SSL:** Let's Encrypt (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ)

### –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–µ –ü–û

```bash
# Node.js
Node.js: v20.20.0
npm: v10.8.2

# –í–µ–±-—Å–µ—Ä–≤–µ—Ä
Nginx: v1.18.0

# –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
PostgreSQL: (–ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–µ—Ä—Å–∏—é: psql --version)

# –ü—Ä–æ—Ü–µ—Å—Å-–º–µ–Ω–µ–¥–∂–µ—Ä (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
PM2: (–ø—Ä–æ–≤–µ—Ä–∏—Ç—å: pm2 --version)
```

### –î–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–µ—Ä—É

**SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ:**
```bash
ssh root@91.198.220.52
# –∏–ª–∏
ssh root@gsbot18.ru
```

**–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è Timeweb:**
```
https://timeweb.cloud/
```

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

### –ö–æ—Ä–Ω–µ–≤–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –ø—Ä–æ–µ–∫—Ç–∞

```
/var/www/gorodsporta/
‚îú‚îÄ‚îÄ .git/                          # Git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
‚îú‚îÄ‚îÄ bot/                           # Backend Node.js
‚îÇ   ‚îú‚îÄ‚îÄ index.js                  # Express server + API
‚îÇ   ‚îú‚îÄ‚îÄ package.json
‚îÇ   ‚îî‚îÄ‚îÄ node_modules/
‚îú‚îÄ‚îÄ webapp-react/                  # React –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (–∏—Å—Ö–æ–¥–Ω–∏–∫–∏)
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ components/           # UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ pages/                # –°—Ç—Ä–∞–Ω–∏—Ü—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ services/             # API –∫–ª–∏–µ–Ω—Ç
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ contexts/             # React –∫–æ–Ω—Ç–µ–∫—Å—Ç—ã
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ main.tsx              # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îÇ   ‚îú‚îÄ‚îÄ dist/                     # –°–æ–±—Ä–∞–Ω–Ω—ã–π –±–∏–ª–¥ (–ø–æ—Å–ª–µ npm run build)
‚îÇ   ‚îú‚îÄ‚îÄ package.json
‚îÇ   ‚îú‚îÄ‚îÄ vite.config.ts
‚îÇ   ‚îî‚îÄ‚îÄ .env                      # –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ deploy/                        # ‚úÖ PRODUCTION —Ñ–∞–π–ª—ã (–æ—Ç–¥–∞–µ—Ç Nginx)
‚îÇ   ‚îú‚îÄ‚îÄ index.html                # –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
‚îÇ   ‚îú‚îÄ‚îÄ debug.html                # –î–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
‚îÇ   ‚îú‚îÄ‚îÄ assets/                   # JS –∏ CSS
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ index-D9_RnF4v.js
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ index-wjuNMKg6.css
‚îÇ   ‚îú‚îÄ‚îÄ favicon.ico
‚îÇ   ‚îú‚îÄ‚îÄ robots.txt
‚îÇ   ‚îî‚îÄ‚îÄ placeholder.svg
‚îú‚îÄ‚îÄ worker/                        # Cloudflare Worker (Telegram bot)
‚îÇ   ‚îî‚îÄ‚îÄ bot.js
‚îú‚îÄ‚îÄ DEPLOY_GUIDE.md               # –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –¥–µ–ø–ª–æ—é
‚îî‚îÄ‚îÄ readme.md
```

### –í–∞–∂–Ω—ã–µ –ø—É—Ç–∏

| –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –ü—É—Ç—å |
|-----------|------|
| **–ò—Å—Ö–æ–¥–Ω–∏–∫–∏ React** | `/var/www/gorodsporta/webapp-react/` |
| **Production —Ñ–∞–π–ª—ã (—Å—Ç–∞—Ç–∏–∫–∞)** | `/var/www/gorodsporta/deploy/` |
| **Backend API** | `/var/www/gorodsporta/bot/` |
| **Nginx –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è** | `/etc/nginx/sites-available/gorodsporta` |
| **–õ–æ–≥–∏ Nginx** | `/var/log/nginx/` |

---

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Nginx

### –§–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

**–ü—É—Ç—å:** `/etc/nginx/sites-available/gorodsporta`

**–°–æ–¥–µ—Ä–∂–∏–º–æ–µ:**

```nginx
server {
    server_name gsbot18.ru www.gsbot18.ru;

    # React SPA static files
    root /var/www/gorodsporta/deploy;  # ‚úÖ –û—Ç–¥–∞–µ–º —Ñ–∞–π–ª—ã –∏–∑ deploy/
    index index.html;

    # index.html - never cache
    location = /index.html {
        add_header Cache-Control "no-cache, no-store, must-revalidate";
        add_header Pragma "no-cache";
        add_header Expires 0;
    }

    # Static assets with hash in name - cache forever
    location /assets/ {
        add_header Cache-Control "public, max-age=31536000, immutable";
    }

    # SPA: –≤—Å–µ –º–∞—Ä—à—Ä—É—Ç—ã -> index.html
    location / {
        try_files $uri $uri/ /index.html;
    }

    # API –∏ webhook -> Node.js
    location /api/ {
        proxy_pass http://127.0.0.1:3000;
        proxy_http_version 1.1;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }

    location /admin/ {
        proxy_pass http://127.0.0.1:8080/;
        proxy_http_version 1.1;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
    }

    location /webhook {
        proxy_pass http://127.0.0.1:3000;
        proxy_http_version 1.1;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }

    listen 443 ssl;
    ssl_certificate /etc/letsencrypt/live/gsbot18.ru/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/gsbot18.ru/privkey.pem;
    include /etc/letsencrypt/options-ssl-nginx.conf;
    ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem;
}

server {
    if ($host = gsbot18.ru) {
        return 301 https://$host$request_uri;
    }

    listen 80;
    server_name gsbot18.ru www.gsbot18.ru;
    return 404;
}
```

### –ö–æ–º–∞–Ω–¥—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è Nginx

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
nginx -t

# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é (–±–µ–∑ –¥–∞—É–Ω—Ç–∞–π–º–∞)
systemctl reload nginx

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å Nginx
systemctl restart nginx

# –°—Ç–∞—Ç—É—Å
systemctl status nginx

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
tail -f /var/log/nginx/access.log
tail -f /var/log/nginx/error.log
```

---

## üîß Backend (Node.js API)

### –†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ

```
/var/www/gorodsporta/bot/
```

### –û—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª

**`bot/index.js`** - Express —Å–µ—Ä–≤–µ—Ä —Å:
- REST API –¥–ª—è Mini App
- Telegram Bot (grammy)
- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ PostgreSQL

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î

```javascript
const pool = new Pool({
    user: "gsadmin",
    password: "GorodSporta2025!",
    host: "localhost",
    port: 5432,
    database: "gorodsporta"
});
```

‚ö†Ô∏è **–í–ê–ñ–ù–û:** –≠—Ç–∏ –¥–∞–Ω–Ω—ã–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ `.env` —Ñ–∞–π–ª–µ, –∞ –Ω–µ –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω—ã!

### API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

| –ú–µ—Ç–æ–¥ | –ü—É—Ç—å | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|------|----------|
| GET | `/api/user/:telegramId` | –ü–æ–ª—É—á–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –µ–≥–æ –∑–∞–¥–∞–Ω–∏—è |
| POST | `/api/complete-task` | –í—ã–ø–æ–ª–Ω–∏—Ç—å –∑–∞–¥–∞–Ω–∏–µ |
| POST | `/api/survey` | –û—Ç–ø—Ä–∞–≤–∏—Ç—å –∞–Ω–∫–µ—Ç—É (–∑–∞–¥–∞–Ω–∏–µ 1) |
| GET | `/api/shop` | –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤ |
| POST | `/api/purchase` | –ö—É–ø–∏—Ç—å —Ç–æ–≤–∞—Ä |
| GET | `/api/leaderboard` | –ü–æ–ª—É—á–∏—Ç—å —Ä–µ–π—Ç–∏–Ω–≥ |
| POST | `/webhook` | Webhook –¥–ª—è Telegram –±–æ—Ç–∞ |

### –ó–∞–ø—É—Å–∫ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

```bash
# –ü–µ—Ä–µ–π—Ç–∏ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
cd /var/www/gorodsporta/bot

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
npm install

# –ó–∞–ø—É—Å–∫ –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
node index.js

# –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ PM2 (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω)
pm2 start index.js --name bot
pm2 restart bot
pm2 stop bot
pm2 logs bot

# –°—Ç–∞—Ç—É—Å PM2
pm2 status
```

### –ü–æ—Ä—Ç—ã

- **Backend API:** `http://localhost:3000`
- **Admin –ø–∞–Ω–µ–ª—å:** `http://localhost:8080`

---

## ‚öõÔ∏è Frontend (React Mini App)

### –ò—Å—Ö–æ–¥–Ω–∏–∫–∏

```
/var/www/gorodsporta/webapp-react/
```

### –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

- **Framework:** React 18 + TypeScript
- **Build Tool:** Vite 5
- **Styling:** TailwindCSS + shadcn/ui
- **State Management:** @tanstack/react-query
- **Animations:** Framer Motion
- **Icons:** Lucide React
- **Telegram SDK:** `https://telegram.org/js/telegram-web-app.js`

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

**–§–∞–π–ª:** `/var/www/gorodsporta/webapp-react/.env`

```env
VITE_API_BASE_URL=https://gsbot18.ru
```

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Vite

**`vite.config.ts`:**

```typescript
export default defineConfig({
  base: "/",  // ‚úÖ –í–∞–∂–Ω–æ –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –ø—É—Ç–µ–π
  server: {
    host: "0.0.0.0",
    port: 8080,
  },
  build: {
    outDir: "dist",
    sourcemap: true,
  },
});
```

### –°–±–æ—Ä–∫–∞ production –±–∏–ª–¥–∞

```bash
# –ü–µ—Ä–µ–π—Ç–∏ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
cd /var/www/gorodsporta/webapp-react

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
npm install

# –°–æ–±—Ä–∞—Ç—å production –±–∏–ª–¥
npm run build

# –†–µ–∑—É–ª—å—Ç–∞—Ç –±—É–¥–µ—Ç –≤ webapp-react/dist/
```

### –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ deploy

```bash
# –ò–∑ –∫–æ—Ä–Ω—è –ø—Ä–æ–µ–∫—Ç–∞
cd /var/www/gorodsporta

# –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å–æ–±—Ä–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
cp -r webapp-react/dist/* deploy/
```

---

## üóÑÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö PostgreSQL

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

```
Host: localhost
Port: 5432
Database: gorodsporta
User: gsadmin
Password: GorodSporta2025!
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü

#### 1. `users` - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏

```sql
CREATE TABLE users (
    id SERIAL PRIMARY KEY,
    telegram_id BIGINT UNIQUE NOT NULL,
    first_name VARCHAR(255),
    last_name VARCHAR(255),
    username VARCHAR(255),
    coins INT DEFAULT 0,
    xp INT DEFAULT 0,
    survey_data JSONB,
    last_activity_at TIMESTAMP,
    created_at TIMESTAMP DEFAULT NOW()
);
```

#### 2. `tasks` - –ó–∞–¥–∞–Ω–∏—è

```sql
CREATE TABLE tasks (
    id SERIAL PRIMARY KEY,
    day_number INT UNIQUE NOT NULL,
    title VARCHAR(255) NOT NULL,
    description TEXT,
    coins_reward INT DEFAULT 0,
    verification_type VARCHAR(50), -- 'qr', 'code', 'self', 'survey', 'app_code'
    verification_data JSONB,
    created_at TIMESTAMP DEFAULT NOW()
);
```

#### 3. `user_tasks` - –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è

```sql
CREATE TABLE user_tasks (
    id SERIAL PRIMARY KEY,
    user_id INT REFERENCES users(id),
    task_id INT REFERENCES tasks(id),
    status VARCHAR(50), -- 'completed'
    completed_at TIMESTAMP,
    verified_by VARCHAR(50),
    UNIQUE(user_id, task_id)
);
```

#### 4. `shop_items` - –¢–æ–≤–∞—Ä—ã –≤ –º–∞–≥–∞–∑–∏–Ω–µ

```sql
CREATE TABLE shop_items (
    id SERIAL PRIMARY KEY,
    title VARCHAR(255),
    description TEXT,
    price INT NOT NULL,
    icon VARCHAR(100),
    image_url TEXT,
    is_active BOOLEAN DEFAULT true,
    created_at TIMESTAMP DEFAULT NOW()
);
```

#### 5. `purchases` - –ü–æ–∫—É–ø–∫–∏

```sql
CREATE TABLE purchases (
    id SERIAL PRIMARY KEY,
    user_id INT REFERENCES users(id),
    item_id INT REFERENCES shop_items(id),
    price_paid INT,
    created_at TIMESTAMP DEFAULT NOW()
);
```

#### 6. `staff_codes` - –ö–æ–¥—ã —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤

```sql
CREATE TABLE staff_codes (
    id SERIAL PRIMARY KEY,
    code VARCHAR(50) UNIQUE NOT NULL,
    task_day INT,
    usage_limit INT DEFAULT 999999,
    used_count INT DEFAULT 0,
    created_by VARCHAR(255),
    created_at TIMESTAMP DEFAULT NOW()
);
```

### –ü–æ–ª–µ–∑–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã

```bash
# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
psql -U gsadmin -d gorodsporta

# –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
SELECT telegram_id, first_name, coins, xp FROM users ORDER BY xp DESC LIMIT 10;

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∑–∞–¥–∞–Ω–∏—è–º
SELECT
    t.day_number,
    t.title,
    COUNT(ut.id) as completed_count
FROM tasks t
LEFT JOIN user_tasks ut ON ut.task_id = t.id AND ut.status = 'completed'
GROUP BY t.id, t.day_number, t.title
ORDER BY t.day_number;

# –í—ã—Ö–æ–¥ –∏–∑ psql
\q
```

---

## üöÄ –ü—Ä–æ—Ü–µ—Å—Å –¥–µ–ø–ª–æ—è

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π —á–µ—Ä–µ–∑ Git

#### –®–∞–≥ 1: –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É

```bash
ssh root@gsbot18.ru
```

#### –®–∞–≥ 2: –ü–µ—Ä–µ—Ö–æ–¥ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞

```bash
cd /var/www/gorodsporta
```

#### –®–∞–≥ 3: –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π

```bash
git pull origin main
```

–ï—Å–ª–∏ –µ—Å—Ç—å –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã –∏–ª–∏ –Ω—É–∂–µ–Ω hard reset:

```bash
git fetch origin
git reset --hard origin/main
```

#### –®–∞–≥ 4: –°–±–æ—Ä–∫–∞ frontend

```bash
cd webapp-react
npm install
npm run build
```

#### –®–∞–≥ 5: –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤

```bash
cd ..
cp -r webapp-react/dist/* deploy/
```

#### –®–∞–≥ 6: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ backend (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

```bash
cd bot
npm install

# –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è PM2
pm2 restart bot

# –ò–ª–∏ –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å Node.js
```

#### –®–∞–≥ 7: –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ Nginx

```bash
nginx -t
systemctl reload nginx
```

#### –®–∞–≥ 8: –ü—Ä–æ–≤–µ—Ä–∫–∞

–û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:
- https://gsbot18.ru/
- https://gsbot18.ru/debug.html

---

### üìú –°–∫—Ä–∏–ø—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–µ–ø–ª–æ—è

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `/var/www/gorodsporta/deploy.sh`:

```bash
#!/bin/bash

echo "üöÄ –ù–∞—á–∏–Ω–∞–µ–º –¥–µ–ø–ª–æ–π –ì–æ—Ä–æ–¥ –°–ø–æ—Ä—Ç–∞..."

# –ü–µ—Ä–µ—Ö–æ–¥ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞
cd /var/www/gorodsporta

# –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –∏–∑ Git
echo "üì• –ü–æ–ª—É—á–∞–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏–∑ GitHub..."
git pull origin main

# –°–±–æ—Ä–∫–∞ frontend
echo "üî® –°–æ–±–∏—Ä–∞–µ–º frontend..."
cd webapp-react
npm install --production=false
npm run build

# –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤
echo "üì¶ –ö–æ–ø–∏—Ä—É–µ–º —Å–æ–±—Ä–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –≤ deploy/..."
cd ..
cp -r webapp-react/dist/* deploy/

# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ backend
echo "üîÑ –û–±–Ω–æ–≤–ª—è–µ–º backend..."
cd bot
npm install --production

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ PM2 (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
if command -v pm2 &> /dev/null; then
    echo "üîÑ –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º PM2..."
    pm2 restart bot
else
    echo "‚ö†Ô∏è PM2 –Ω–µ –Ω–∞–π–¥–µ–Ω, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫"
fi

# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ Nginx
echo "üîÑ –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º Nginx..."
nginx -t && systemctl reload nginx

echo "‚úÖ –î–µ–ø–ª–æ–π –∑–∞–≤–µ—Ä—à–µ–Ω!"
echo "üåê –ü—Ä–æ–≤–µ—Ä—å—Ç–µ: https://gsbot18.ru/"
echo "üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞: https://gsbot18.ru/debug.html"
```

**–°–¥–µ–ª–∞—Ç—å –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º:**

```bash
chmod +x /var/www/gorodsporta/deploy.sh
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**

```bash
cd /var/www/gorodsporta
./deploy.sh
```

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏

### –õ–æ–≥–∏ Nginx

```bash
# Access –ª–æ–≥–∏ (–≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã)
tail -f /var/log/nginx/access.log

# Error –ª–æ–≥–∏
tail -f /var/log/nginx/error.log

# –ü–æ–∏—Å–∫ –æ—à–∏–±–æ–∫ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π —á–∞—Å
grep "error" /var/log/nginx/error.log | tail -100
```

### –õ–æ–≥–∏ Node.js Backend

```bash
# –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è PM2
pm2 logs bot

# –¢–æ–ª—å–∫–æ –æ—à–∏–±–∫–∏
pm2 logs bot --err

# –ü–æ—Å–ª–µ–¥–Ω–∏–µ 100 —Å—Ç—Ä–æ–∫
pm2 logs bot --lines 100
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤

```bash
# –°–ø–∏—Å–æ–∫ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ Node.js
ps aux | grep node

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
top
htop

# PM2 –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
pm2 monit
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä—Ç–æ–≤

```bash
# –ö–∞–∫–∏–µ –ø–æ—Ä—Ç—ã —Å–ª—É—à–∞—é—Ç
netstat -tulpn | grep LISTEN

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä—Ç–∞ 3000 (backend)
netstat -tulpn | grep 3000

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä—Ç–∞ 5432 (PostgreSQL)
netstat -tulpn | grep 5432
```

---

## üîß Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è

**–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:**

1. –û—Ç–∫—Ä–æ–π—Ç–µ https://gsbot18.ru/debug.html
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤—Å–µ —Ç–µ—Å—Ç—ã:
   - ‚úÖ Telegram WebApp SDK
   - ‚úÖ API –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å
   - ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ –∞—Å—Å–µ—Ç–æ–≤

3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ Nginx:
```bash
tail -f /var/log/nginx/error.log
```

4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Ñ–∞–π–ª—ã –Ω–∞ –º–µ—Å—Ç–µ:
```bash
ls -la /var/www/gorodsporta/deploy/
```

**–†–µ—à–µ–Ω–∏–µ:**

- –ï—Å–ª–∏ 404 –Ω–∞ –∞—Å—Å–µ—Ç—ã ‚Üí –ø–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –∏ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –±–∏–ª–¥
- –ï—Å–ª–∏ –æ—à–∏–±–∫–∏ API ‚Üí –ø—Ä–æ–≤–µ—Ä–∏—Ç—å backend
- –ï—Å–ª–∏ –±–µ–ª—ã–π —ç–∫—Ä–∞–Ω ‚Üí –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12)

---

### –ü—Ä–æ–±–ª–µ–º–∞: API –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç

**–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:**

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –∑–∞–ø—É—â–µ–Ω –ª–∏ –ø—Ä–æ—Ü–µ—Å—Å
pm2 status

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
pm2 logs bot

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ—Ä—Ç
curl http://localhost:3000/api/leaderboard
```

**–†–µ—à–µ–Ω–∏–µ:**

```bash
# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å backend
pm2 restart bot

# –ï—Å–ª–∏ PM2 –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è - –Ω–∞–π—Ç–∏ –ø—Ä–æ—Ü–µ—Å—Å
ps aux | grep "node.*bot"

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Ä—É—á–Ω—É—é
cd /var/www/gorodsporta/bot
node index.js
```

---

### –ü—Ä–æ–±–ª–µ–º–∞: –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞

**–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:**

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å PostgreSQL
systemctl status postgresql

# –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è
psql -U gsadmin -d gorodsporta
```

**–†–µ—à–µ–Ω–∏–µ:**

```bash
# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å PostgreSQL
systemctl restart postgresql

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–∞—Ä–æ–ª—å
# –í bot/index.js –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–∞—Ä–æ–ª—å
```

---

### –ü—Ä–æ–±–ª–µ–º–∞: –ü–æ—Å–ª–µ git pull –Ω–∏—á–µ–≥–æ –Ω–µ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å

**–ü—Ä–∏—á–∏–Ω–∞:** –ó–∞–±—ã–ª–∏ –ø–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –∏ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –±–∏–ª–¥

**–†–µ—à–µ–Ω–∏–µ:**

```bash
cd /var/www/gorodsporta/webapp-react
npm run build
cd ..
cp -r webapp-react/dist/* deploy/
systemctl reload nginx
```

---

### –ü—Ä–æ–±–ª–µ–º–∞: 502 Bad Gateway

**–ü—Ä–∏—á–∏–Ω–∞:** Backend –Ω–µ –∑–∞–ø—É—â–µ–Ω –∏–ª–∏ –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –ø–æ—Ä—Ç—É 3000

**–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:**

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —Å–ª—É—à–∞–µ—Ç –ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—Ä—Ç 3000
netstat -tulpn | grep 3000

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ Nginx
tail -f /var/log/nginx/error.log
```

**–†–µ—à–µ–Ω–∏–µ:**

```bash
cd /var/www/gorodsporta/bot
pm2 restart bot
# –∏–ª–∏
node index.js
```

---

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–°–µ–∫—Ä–µ—Ç—ã –≤ –∫–æ–¥–µ:**
   - ‚ùå –ù–ï —Ö—Ä–∞–Ω–∏—Ç–µ –ø–∞—Ä–æ–ª–∏ –ë–î –∏ —Ç–æ–∫–µ–Ω—ã –≤ –∫–æ–¥–µ
   - ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `.env` —Ñ–∞–π–ª—ã
   - ‚úÖ –î–æ–±–∞–≤—å—Ç–µ `.env` –≤ `.gitignore`

2. **Telegram Bot Token:**
   - –¢–µ–∫—É—â–∏–π: `8091797199:AAHAhjl7ooj4ajYdoxZwl-B4AtRlrj_WZqI`
   - ‚ö†Ô∏è –í—ã–Ω–µ—Å—Ç–∏ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è!

3. **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:**
   - –¢–µ–∫—É—â–∏–π –ø–∞—Ä–æ–ª—å: `GorodSporta2025!`
   - ‚ö†Ô∏è –ù–µ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ –ø—É–±–ª–∏—á–Ω–æ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏!

4. **Firewall:**
   - –ó–∞–∫—Ä—ã—Ç—å –≤—Å–µ –ø–æ—Ä—Ç—ã –∫—Ä–æ–º–µ 22 (SSH), 80 (HTTP), 443 (HTTPS)
   - PostgreSQL (5432) –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–µ–Ω —Ç–æ–ª—å–∫–æ –ª–æ–∫–∞–ª—å–Ω–æ

5. **SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç:**
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ certbot
   - –ü—Ä–æ–≤–µ—Ä–∫–∞: `certbot certificates`

---

## üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã –∏ —Å—Å—ã–ª–∫–∏

### –í–∞–∂–Ω—ã–µ URL

- **–°–∞–π—Ç:** https://gsbot18.ru/
- **–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:** https://gsbot18.ru/debug.html
- **GitHub:** https://github.com/votkatya/gsbot
- **Telegram Bot:** @gorodsporta_bot (–∏–ª–∏ –∫–∞–∫ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è)

### –ü–∞–Ω–µ–ª–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

- **Timeweb:** https://timeweb.cloud/
- **Cloudflare (Worker):** https://dash.cloudflare.com/

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **Telegram Mini Apps:** https://core.telegram.org/bots/webapps
- **Vite:** https://vitejs.dev/
- **React:** https://react.dev/
- **Nginx:** https://nginx.org/ru/docs/

---

## üìù –ß–µ–∫–ª–∏—Å—Ç –¥–ª—è –Ω–æ–≤–æ–≥–æ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞

### –ü–µ—Ä–≤–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ

- [ ] –ü–æ–ª—É—á–∏—Ç—å SSH –¥–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–µ—Ä—É
- [ ] –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –ª–æ–∫–∞–ª—å–Ω–æ: `git clone https://github.com/votkatya/gsbot.git`
- [ ] –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Node.js v20+ –ª–æ–∫–∞–ª—å–Ω–æ
- [ ] –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: `cd webapp-react && npm install`
- [ ] –ó–∞–ø—É—Å—Ç–∏—Ç—å dev —Å–µ—Ä–≤–µ—Ä: `npm run dev`
- [ ] –ò–∑—É—á–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä–æ–µ–∫—Ç–∞

### –ü–µ—Ä–µ–¥ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏

- [ ] –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –≤–µ—Ç–∫—É: `git checkout -b feature/–Ω–∞–∑–≤–∞–Ω–∏–µ`
- [ ] –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –ª–æ–∫–∞–ª—å–Ω–æ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
- [ ] –ó–∞–∫–æ–º–º–∏—Ç–∏—Ç—å: `git commit -m "–æ–ø–∏—Å–∞–Ω–∏–µ"`
- [ ] –ó–∞–ø—É—à–∏—Ç—å: `git push origin feature/–Ω–∞–∑–≤–∞–Ω–∏–µ`

### –î–µ–ø–ª–æ–π –Ω–∞ production

- [ ] –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É: `ssh root@gsbot18.ru`
- [ ] –ü–µ—Ä–µ–π—Ç–∏ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é: `cd /var/www/gorodsporta`
- [ ] –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–¥: `git pull origin main`
- [ ] –°–æ–±—Ä–∞—Ç—å frontend: `cd webapp-react && npm run build`
- [ ] –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ñ–∞–π–ª—ã: `cp -r dist/* ../deploy/`
- [ ] –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å backend (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ): `pm2 restart bot`
- [ ] –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å Nginx: `systemctl reload nginx`
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å: https://gsbot18.ru/

---

## üéØ –ë—ã—Å—Ç—Ä—ã–µ –∫–æ–º–∞–Ω–¥—ã (—à–ø–∞—Ä–≥–∞–ª–∫–∞)

```bash
# === –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ ===
ssh root@gsbot18.ru

# === –ü–µ—Ä–µ—Ö–æ–¥ –≤ –ø—Ä–æ–µ–∫—Ç ===
cd /var/www/gorodsporta

# === –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ GitHub ===
git pull origin main

# === –°–±–æ—Ä–∫–∞ frontend ===
cd webapp-react && npm install && npm run build && cd ..

# === –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ production ===
cp -r webapp-react/dist/* deploy/

# === –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ Nginx ===
nginx -t && systemctl reload nginx

# === –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ backend ===
pm2 restart bot

# === –õ–æ–≥–∏ ===
tail -f /var/log/nginx/error.log
pm2 logs bot

# === –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö ===
psql -U gsadmin -d gorodsporta
```

---

## üìö –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

| –î–∞—Ç–∞ | –í–µ—Ä—Å–∏—è | –ò–∑–º–µ–Ω–µ–Ω–∏—è |
|------|--------|-----------|
| 12.02.2026 | 1.0 | –ü–µ—Ä–≤–∞—è –≤–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ |

---

**–î–æ–∫—É–º–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω –¥–ª—è –∫–æ–º–∞–Ω–¥—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞ "–ì–æ—Ä–æ–¥ –°–ø–æ—Ä—Ç–∞"**
*–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –≤–æ–ø—Ä–æ—Å–æ–≤ –æ–±—Ä–∞—â–∞–π—Ç–µ—Å—å –∫ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–º—É –∑–∞ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É*
